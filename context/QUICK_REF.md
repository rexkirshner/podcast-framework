# Quick Reference

**Auto-generated by `/save-full`** - Do not edit manually

---

## Project: Strange Water Podcast Website

**Current:** Phase 2c | **Session:** 18 | **Progress:** Code Review Complete, Context Feedback Synthesized

## Tech Stack

- **Framework:** Astro 5.1.4 (SSG, TypeScript strict mode)
- **CMS:** Sanity.io (project ID: ej6443ov, dataset: production)
- **Hosting:** Netlify (auto-deploy on git push)
- **Styling:** Tailwind CSS v4 + CMS-driven theming
- **Language:** TypeScript (strict mode)
- **Email:** Resend (contribution@noreply.strangewater.xyz verified)
- **Analytics:** Google Analytics 4
- **Serverless Functions:** 2 functions (newsletter-subscribe, contribute)

## URLs

- **Production:** https://strangewater.xyz ✅ LIVE
- **Staging:** ~~https://staging.strangewater.xyz~~ (decommissioned)
- **Local (Astro):** http://localhost:4321/
- **Local (Sanity):** http://localhost:3333/
- **Repository:** https://github.com/rexkirshner/podcast-framework

## Current Focus

**Phase:** Phase 2c - Production Operations & Hosting Portability

**Active Task:** Session 18 complete - code review and context feedback documented

**Session 18 Accomplishments:**
- ✅ Code review complete (Grade: A - zero security/performance issues)
- ✅ Context system feedback synthesized (1,238 lines of recommendations)
- ✅ System assessment: A- grade (92/100) - fundamentally excellent

**Next Priorities:**
1. Await user direction (potential: more features, Cloudflare migration, or break)
2. Production site stable, all systems operational
3. Hosting abstraction code ready for deployment when needed

## Quick Commands

```bash
# Development
npm run dev                    # Start Astro dev server (localhost:4321)
npm run sanity                 # Start Sanity Studio (localhost:3333)
npm run build                  # Build for production (146 pages, 30s)
npm test                       # Run all tests (40 passing)

# Content Management
node scripts/import-episodes.js     # Import episodes from Anchor RSS
node scripts/link-guests.js         # Auto-link guests to episodes
node scripts/update-durations.js    # Fix episode durations

# Netlify Functions (serverless)
netlify dev                    # Test functions locally (NOT npm run dev)

# Context System
/save-context                  # Update all context docs + commit
/code-review                   # Run comprehensive code audit
/review-context                # Validate context system integrity
```

## Project Status

**Production:** ✅ Live at strangewater.xyz
**Build Status:** ✅ 146 pages, zero errors, 30s build time
**Code Quality:** A (hosting abstraction refactor validated)
**Security:** ✅ All controls validated (input validation, XSS, rate limiting)
**Performance:** ✅ Improved (45-59% code reduction, faster cold starts)
**Vendor Lock-in:** 3/10 (low - abstraction layer implemented)

## Critical Protocols

⚠️ **GIT PUSH PERMISSION:** NEVER push to GitHub without explicit user permission (triggers Netlify build, consumes quota)

## Recent Work (Session 18)

**Accomplished:**
- ✅ Comprehensive code review (hosting abstraction refactor)
- ✅ Security audit passed (all controls maintained)
- ✅ Performance validated (no regressions, actually improved)
- ✅ Code quality confirmed (clean architecture, improved testability)
- ✅ Claude Context System feedback synthesized (1,238 lines)
- ✅ Top 5 high-priority recommendations identified

**Files Created:**
- `artifacts/code-reviews/session-18-refactor-review.md` (650+ lines)
- `context/claude-context-feedback.md` - Appended comprehensive feedback (1,238 lines)

**Documentation Updated:**
- `context/SESSIONS.md` - Session 18 comprehensive entry
- `context/STATUS.md` - Updated with Session 18 accomplishments
- `context/QUICK_REF.md` - This file (auto-generated)

## Hosting Abstraction Status

- [x] **Sprint 1:** Extract business logic to `src/server/` (✅ Complete - Session 17)
- [x] **Sprint 2:** Add provider adapter pattern (✅ Complete - Session 17)
- [x] **Code Review:** Security and performance validation (✅ Complete - Session 18, Grade: A)
- [ ] **Deploy to Cloudflare:** Ready when needed (code complete, migration guide ready)

**Achievement:** Vendor lock-in reduced from 6/10 → 3/10, migration effort reduced 74% (31h → 8h)

## Hosting Providers Comparison

| Provider | Cost | Bandwidth | Lock-in | Migration Effort |
|----------|------|-----------|---------|------------------|
| **Netlify (current)** | $0/mo | 100 GB | 6/10 | N/A |
| **Cloudflare Pages** | $0/mo | ∞ Unlimited | 5/10 | 16-24 hrs (after abstraction: 8 hrs) |
| **Vercel** | $20/mo | 100 GB | 7/10 | 20-32 hrs (after abstraction: 8 hrs) |
| **AWS Amplify** | ~$5-10/mo | ~5K visits | 8/10 | 40-60 hrs (no official adapter) |

**Recommendation:** Implement abstraction layer first, then decide on migration based on traffic growth.

## Content Stats

- **Episodes:** 69 (all with metadata, durations, Spotify embeds)
- **Guests:** 72 (65 with profile photos)
- **Episode Covers:** 66/68 uploaded
- **Guest-Episode Links:** 63/67 auto-linked
- **Build Output:** 146 static pages

## Key Files

- **Context Entry Point:** `context/CONTEXT.md`
- **Current Status:** `context/STATUS.md` (this summary's source)
- **Session History:** `context/SESSIONS.md`
- **Decision Log:** `context/DECISIONS.md`
- **Hosting Analysis:** `context/tasks/hosting-migration-analysis.md`
- **Git Protocol Feedback:** `context/claude-context-feedback.md`

## Known Issues

**None** - All production issues resolved:
- ✅ Contribute button fixed (serverless compatibility)
- ✅ DNS migration complete
- ✅ Email notifications working

## Next Session Options

**Session 18 Complete** - Await user direction:

**Option A: Continue Feature Development**
- Episode transcripts via Whisper API (10-15 hours, $25 total)
- Episode search functionality (4-6 hours, client-side)
- Episode platform links - Phase 1 manual (4 hours, CSV import)

**Option B: Deploy Cloudflare Migration**
- Code is ready, just needs deployment
- Migration guide complete: `context/tasks/cloudflare-migration-guide.md`
- Estimated time: 4-6 hours (including testing)

**Option C: Take a Break**
- Production site is stable
- All features working
- Code quality excellent (Grade: A)
- Good stopping point

**Recommendation:** User decides based on priorities
