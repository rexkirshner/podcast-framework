---
/**
 * Block Content Renderer
 *
 * Renders Sanity's portable text/block content
 * Simple implementation for common block types
 */

interface Props {
  blocks?: any[];
  class?: string;
}

const { blocks, class: className } = Astro.props;

if (!blocks || blocks.length === 0) {
  return null;
}

// Simple block content renderer
function renderBlock(block: any): string {
  if (block._type === 'block') {
    const text = block.children?.map((child: any) => {
      let content = child.text || '';

      // Apply marks (bold, italic, etc.)
      if (child.marks && child.marks.length > 0) {
        child.marks.forEach((mark: string) => {
          if (mark === 'strong') content = `<strong>${content}</strong>`;
          if (mark === 'em') content = `<em>${content}</em>`;
          if (mark === 'code') content = `<code>${content}</code>`;
        });
      }

      return content;
    }).join('') || '';

    // Render block based on style
    const style = block.style || 'normal';

    if (style === 'h1') return `<h1 class="text-3xl font-bold mb-4">${text}</h1>`;
    if (style === 'h2') return `<h2 class="text-2xl font-bold mb-3">${text}</h2>`;
    if (style === 'h3') return `<h3 class="text-xl font-semibold mb-2">${text}</h3>`;
    if (style === 'h4') return `<h4 class="text-lg font-semibold mb-2">${text}</h4>`;
    if (style === 'blockquote') return `<blockquote class="border-l-4 border-gray-300 pl-4 italic my-4">${text}</blockquote>`;

    return `<p class="text-lg text-gray-700 leading-relaxed mb-6">${text}</p>`;
  }

  return '';
}

const renderedContent = blocks.map(renderBlock).join('');
---

<div class:list={[className, "prose max-w-none"]} set:html={renderedContent} />
